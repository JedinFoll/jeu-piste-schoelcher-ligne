<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Jeu de Piste ‚Äì Sch≈ìlcher</title>
<link href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&display=swap" rel="stylesheet">
<style>
  :root{ --ink:#f5f0e6; --marron:#5a2e0c; --marron-light:#7a3e21; --marron-dark:#2d1405; --frame:#a97442; --shadow:rgba(0,0,0,.4); }
  body{font-family:'Trebuchet MS',Arial,sans-serif;background:var(--marron);margin:0;padding:24px;line-height:1.6;color:var(--ink)}
  .hero{background:var(--marron-light);border:3px solid var(--frame);border-radius:12px;padding:18px;margin-bottom:18px;box-shadow:4px 4px 8px var(--shadow)}
  .hero h1{font-family:'Alfa Slab One',serif;color:#f5e1c4;text-shadow:2px 2px 0 var(--marron-dark)}
  .card{background:#fffdf4;border:2px solid var(--frame);border-radius:12px;padding:18px;margin-top:16px;color:#2d1a0a;box-shadow:3px 3px 6px var(--shadow)}
  .btn{padding:10px 16px;border-radius:8px;border:2px solid var(--frame);background:#d4a373;color:#2d1a0a;font-weight:700;cursor:pointer;box-shadow:2px 2px 4px var(--shadow)}
  .btn:hover{background:#b97d4e;color:#fff}
  .btn.primary{background:var(--marron-light);color:#fff;border-color:var(--marron-dark)}
  .btn.primary:hover{background:var(--marron-dark)}
  input[type=text]{padding:10px 12px;border:2px solid var(--frame);border-radius:10px;min-width:220px}
  .badge{padding:.25rem .5rem;border-radius:.5rem;border:2px solid #ccc;font-size:.85rem}
  .ok{background:#e9fbe9;border-color:#bfe9bf;color:#164a16}
  .ko{background:#fff0f0;border-color:#f2c1c1;color:#7b1a1a}
  .enigme{display:none}
  .parchment{background:radial-gradient(ellipse at 30% 20%, #fff6d9 0%, #fff0c9 40%, #f6e4b6 70%, #ecd9a6 100%);border:1px solid #c9a96b;color:#3a240d;padding:16px;border-radius:10px;box-shadow:0 3px 12px rgba(0,0,0,.25), inset 0 0 40px rgba(125,72,23,.15)}
  .parchment h3{margin-top:0;font-family:'Alfa Slab One',serif}
</style>
</head>
<body>
  <div class="hero">
    <h1>Jeu de Piste ‚Äì Sch≈ìlcher</h1>
    <p>Munis-toi de papier et crayon, scanne les QR codes et r√©sous les √©nigmes.</p>
  </div>

  <!-- Acc√®s -->
  <section class="card" id="acces">
    <h2>Acc√®s au jeu</h2>
    <div class="row">
      <input type="text" id="playerName" placeholder="Ton pseudo" />
      <input type="text" id="codeInput" placeholder="Code d‚Äôacc√®s" />
      <button class="btn" id="btnValiderCode">Valider</button>
      <span id="badge" class="badge ko">verrouill√©</span>
    </div>
    <button class="btn primary" id="btnCommencer" disabled>Commencer le jeu</button>
    <button class="btn" id="btnScanner" disabled>Scanner le QR code</button>
  </section>

  <!-- √ânigmes -->
  <section id="bloc-enigmes" class="card" style="display:none;">
    <h2>√ânigmes</h2>
    <article id="enigme1" class="enigme">
      <div class="parchment">
        <h3>üó∫Ô∏è √ânigme 1</h3>
        <p><b>La sym√©trie t'emportera au premier endroit.</b></p>
        <p>L√† o√π l‚Äô√©lectricit√© est source d‚Äô√©nergie, tu trouveras l‚Äôessence de ta qu√™te.</p>
      </div>
    </article>
    <article id="enigme2" class="enigme">
      <div class="parchment">
        <h3>üåø √ânigme 2</h3>
        <p><b>Passage Ombrag√©<br>Nature Tagu√©e</b></p>
        <p>Repr√©sentent ta prochaine destination.</p>
      </div>
    </article>
    <article id="enigme3" class="enigme"><h3>√ânigme 3</h3></article>
    <article id="enigme4" class="enigme"><h3>√ânigme 4</h3></article>
    <article id="fin" class="enigme"><h3>Bravo üéâ</h3><p>Tu as termin√© le parcours !</p></article>
  </section>

  <!-- Scanner modal -->
  <div id="scanModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);align-items:center;justify-content:center;">
    <div style="background:#fff;padding:16px;border-radius:10px;max-width:400px;width:100%">
      <h3>Scanner un QR code</h3>
      <input type="text" id="qrManual" placeholder="Code QR manuel (ex: ENIGME-2)" />
      <button class="btn" id="btnValiderQR">Valider</button>
      <button class="btn" id="btnFermerScan">Fermer</button>
      <p id="scanMsg"></p>
    </div>
  </div>

<script>
  const ACCESS_CODES=["SCHOELCHER-10"];
  const QR_FLOW=[
    {nextId:"enigme2",value:"ENIGME-2"},
    {nextId:"enigme3",value:"ENIGME-3"},
    {nextId:"enigme4",value:"ENIGME-4"},
    {nextId:"fin",value:"FIN"}
  ];
  const normalize=s=>(s||"").normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/[\s_\/\\-]+/g,'').toUpperCase();
  const badge=document.getElementById("badge"),btnCommencer=document.getElementById("btnCommencer"),btnScanner=document.getElementById("btnScanner"),blocEnigmes=document.getElementById("bloc-enigmes");
  const btnValiderCode=document.getElementById("btnValiderCode"),codeInput=document.getElementById("codeInput"),playerNameInput=document.getElementById("playerName");

  btnValiderCode.addEventListener("click",()=>{
    const code=normalize(codeInput.value);
    if(!playerNameInput.value.trim()||!ACCESS_CODES.map(normalize).includes(code)){alert("Pseudo ou code invalide");return;}
    badge.textContent="d√©verrouill√©";badge.className="badge ok";btnCommencer.disabled=false;
  });

  btnCommencer.addEventListener("click",()=>{
    blocEnigmes.style.display="block";
    document.getElementById("enigme1").style.display="block";
    btnScanner.disabled=false;
  });

  // Gestion QR
  const scanModal=document.getElementById("scanModal"),btnValiderQR=document.getElementById("btnValiderQR"),btnFermerScan=document.getElementById("btnFermerScan"),qrManual=document.getElementById("qrManual"),scanMsg=document.getElementById("scanMsg");
  btnScanner.addEventListener("click",()=>{scanModal.style.display="flex";scanMsg.textContent="";qrManual.value="";});
  btnFermerScan.addEventListener("click",()=>scanModal.style.display="none");
  btnValiderQR.addEventListener("click",()=>{
    const v=(qrManual.value||"").trim();
    const item=QR_FLOW.find(x=>x.value===v);
    if(item){document.getElementById(item.nextId).style.display="block";scanMsg.textContent="‚úÖ D√©bloqu√©";}else{scanMsg.textContent="‚ùå Code invalide";}
  });
</script>
</body>
</html>
