<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Jeu de Piste – Schœlcher</title>
<style>
  :root{--blue:#0070ba;--bg:#f7f7f9}
  *{box-sizing:border-box}
  body{font-family:system-ui,Arial,sans-serif;background:var(--bg);margin:0;padding:24px;line-height:1.6;color:#111}
  h1,h2,h3{margin:0 0 .6rem}
  p{margin:.25rem 0 .9rem}
  .row{display:flex;gap:.6rem;flex-wrap:wrap;margin:.4rem 0 1rem}
  .btn{display:inline-block;padding:10px 16px;border-radius:10px;text-decoration:none;font-weight:600;border:1px solid #dcdce0;background:#fff;cursor:pointer}
  .btn:hover{background:#eee}
  .btn.primary{background:var(--blue);border-color:var(--blue);color:#fff}
  .btn.primary[disabled]{opacity:.55;cursor:not-allowed}
  .muted{color:#666;font-size:.95rem}
  .card{background:#fff;border:1px solid #e6e6ea;border-radius:14px;padding:16px;margin-top:16px}
  input[type=text],input[type=email]{padding:10px 12px;border:1px solid #dcdce0;border-radius:10px;min-width:260px}

  /* --- Carte (image) en mode paysage --- */
  .map-wrap{position:relative; width:100%; overflow:auto; background:#fafafa; border:1px solid #e6e6ea; border-radius:14px;}
  .map-frame{width:100%; height:min(80vh,700px); display:flex; align-items:center; justify-content:center;}
  .map-img{
    max-height:100%;
    /* L’image fournie est en portrait : on la fait pivoter pour l’afficher en paysage */
    transform: rotate(90deg);
    transform-origin:center center;
    display:block;
  }
  /* astuce : on évite que l’image dépasse horizontalement après rotation */
  .map-inner{min-width:1200px; display:flex; align-items:center; justify-content:center;}

  .badge{display:inline-block;padding:.25rem .5rem;border-radius:.5rem;border:1px solid #ccc;font-size:.85rem}
  .ok{background:#e9fbe9;border-color:#bfe9bf;color:#164a16}
  .ko{background:#fff4f4;border-color:#ffd7d7;color:#7b1a1a}

  .enigme{display:none}
  .enigme.active{display:block}
  .hr{height:1px;background:#ececf2;margin:16px 0}
  footer{margin-top:28px;color:#555;font-size:.9rem}
</style>
</head>
<body>
  <header>
    <h1>Jeu de Piste – Schœlcher</h1>
    <p>Munis-toi de papier et crayon, scanne les QR codes et résous les énigmes.</p>
    <p>Le jeu coûte 10 € — accès après paiement ou code.</p>
  </header>

  <!-- ACCÈS -->
  <section class="card" id="acces">
    <h2>Accès au jeu</h2>
    <div class="row">
      <!-- Ton lien PayPal NCP -->
      <a class="btn primary" target="_blank" rel="noopener"
         href="https://www.paypal.com/ncp/payment/GLM2FB7ERYXKQ">💳 Payer 10 € (PayPal)</a>

      <!-- Code d’accès (que TU donnes après avoir vérifié la transaction) -->
      <input type="text" id="codeInput" placeholder="Entrer le code d’accès" />
      <button class="btn" id="btnValiderCode">Valider le code</button>
    </div>

    <!-- Collecte du n° de paiement pour que TU vérifies -->
    <div class="row">
      <input type="text"  id="payerName"  placeholder="Nom / Prénom" />
      <input type="email" id="payerEmail" placeholder="Email" />
      <input type="text"  id="payerTxn"   placeholder="N° de paiement PayPal" />
      <button class="btn" id="btnEnvoyerPreuve">Envoyer la preuve</button>
    </div>

    <p class="muted">Statut : <span id="badge" class="badge ko">verrouillé</span></p>
    <div class="hr"></div>

    <!-- Bouton Commencer bloqué tant que pas déverrouillé -->
    <button class="btn primary" id="btnCommencer" disabled>Commencer le jeu</button>
  </section>

  <!-- TA CARTE (image) EN MODE PAYSAGE -->
  <section class="card">
    <h2>Carte du parcours</h2>
    <p class="muted">Zoom possible avec les doigts (mobile) ou Ctrl/⌘ + molette (ordinateur).</p>
    <div class="map-wrap">
      <div class="map-frame">
        <div class="map-inner">
          <!-- Mets le bon nom de fichier si différent -->
          <img class="map-img" src="carte-schoelcher.jpg" alt="Carte du jeu de piste à Schœlcher (mode paysage)">
        </div>
      </div>
    </div>
    <div class="row">
      <a class="btn" download href="carte-schoelcher.jpg">Télécharger la carte</a>
    </div>
  </section>

  <!-- ÉNIGMES (remplace les textes par les tiens) -->
  <section id="bloc-enigmes" class="card" style="display:none;">
    <h2>Énigmes</h2>
    <p class="muted">Remplace les paragraphes ci-dessous par TES énigmes.</p>

    <article id="enigme1" class="enigme active">
      <h3>Énigme 1</h3>
      <p><em>(Ton texte d’énigme 1 ici)</em></p>
      <div class="row">
        <a class="btn" href="#enigme2" onclick="showEnigme('enigme2')">Aller à l’Énigme 2</a>
      </div>
    </article>

    <article id="enigme2" class="enigme">
      <h3>Énigme 2</h3>
      <p><em>(Ton texte d’énigme 2 ici)</em></p>
      <div class="row">
        <a class="btn" href="#enigme1" onclick="showEnigme('enigme1')">Retour Énigme 1</a>
        <a class="btn" href="#enigme3" onclick="showEnigme('enigme3')">Aller à l’Énigme 3</a>
      </div>
    </article>

    <article id="enigme3" class="enigme">
      <h3>Énigme 3</h3>
      <p><em>(Ton texte d’énigme 3 ici)</em></p>
      <div class="row">
        <a class="btn" href="#enigme2" onclick="showEnigme('enigme2')">Retour Énigme 2</a>
        <a class="btn" href="#enigme4" onclick="showEnigme('enigme4')">Aller à l’Énigme 4</a>
      </div>
    </article>

    <article id="enigme4" class="enigme">
      <h3>Énigme 4</h3>
      <p><em>(Ton texte d’énigme 4 ici)</em></p>
      <div class="row">
        <a class="btn" href="#enigme3" onclick="showEnigme('enigme3')">Retour Énigme 3</a>
        <a class="btn" href="#fin" onclick="showEnigme('fin')">Terminer</a>
      </div>
    </article>

    <article id="fin" class="enigme">
      <h3>Bravo 🎉</h3>
      <p>Tu as terminé le parcours !</p>
      <a class="btn" href="#" onclick="window.scrollTo({top:0,behavior:'smooth'})">Retour à l’accueil</a>
    </article>
  </section>

  <footer>
    <span class="muted">Besoin d’aide pour remplacer les textes ? Dis-moi tes énigmes et je colle tout pour toi.</span>
  </footer>

  <script>
    // ====== Réglages à personnaliser ======
    const CONTACT_EMAIL = "ton.email@example.com"; // ← Mets TON email (réception des preuves)
    const ACCESS_CODE   = "SCHOELCHER-10";         // ← Le code que TU donnes après vérif PayPal
    const LS_KEY        = "jp_schoelcher_unlocked_v1";

    // ====== Logique d'accès ======
    const badge = document.getElementById("badge");
    const btnCommencer = document.getElementById("btnCommencer");
    const blocEnigmes = document.getElementById("bloc-enigmes");
    const codeInput = document.getElementById("codeInput");
    const btnValiderCode = document.getElementById("btnValiderCode");
    const btnEnvoyerPreuve = document.getElementById("btnEnvoyerPreuve");

    setAccess(localStorage.getItem(LS_KEY) === "1");

    btnValiderCode.addEventListener("click", () => {
      const v = (codeInput.value || "").trim();
      if (!v) return alert("Entre le code d’accès.");
      if (v === ACCESS_CODE) {
        setAccess(true);
        alert("Code valide ✅ Accès déverrouillé.");
      } else {
        alert("Code invalide ❌");
      }
    });

    btnEnvoyerPreuve.addEventListener("click", () => {
      const name = (document.getElementById("payerName").value||"").trim();
      const email= (document.getElementById("payerEmail").value||"").trim();
      const txn  = (document.getElementById("payerTxn").value||"").trim();
      if(!txn) return alert("Entre ton N° de paiement PayPal.");
      const subject = encodeURIComponent("Preuve de paiement – Jeu de Piste Schœlcher");
      const body = encodeURIComponent(
        `Bonjour,\n\nVoici ma preuve de paiement :\n- Nom : ${name}\n- Email : ${email}\n- N° de paiement PayPal : ${txn}\n\nMerci de m’envoyer le code d’accès.\n`
      );
      window.location.href = `mailto:${encodeURIComponent(CONTACT_EMAIL)}?subject=${subject}&body=${body}`;
    });

    btnCommencer.addEventListener("click", () => {
      if (btnCommencer.disabled) return;
      blocEnigmes.style.display = "block";
      showEnigme("enigme1");
      blocEnigmes.scrollIntoView({behavior:"smooth"});
    });

    function setAccess(ok){
      if (ok) {
        localStorage.setItem(LS_KEY, "1");
        btnCommencer.disabled = false;
        badge.textContent = "déverrouillé";
        badge.classList.remove("ko"); badge.classList.add("ok");
        blocEnigmes.style.display = "block";
      } else {
        localStorage.removeItem(LS_KEY);
        btnCommencer.disabled = true;
        badge.textContent = "verrouillé";
        badge.classList.remove("ok"); badge.classList.add("ko");
        blocEnigmes.style.display = "none";
      }
    }

    // Navigation entre énigmes
    function showEnigme(id){
      document.querySelectorAll(".enigme").forEach(e => e.classList.remove("active"));
      const el = document.getElementById(id);
      if (el){ el.classList.add("active"); location.hash = id; }
    }
    window.showEnigme = showEnigme;
  </script>
</body>
</html>
